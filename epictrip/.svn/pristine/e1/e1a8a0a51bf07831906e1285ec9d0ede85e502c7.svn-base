package com.web.epictrip.controller;

import java.util.List;

import org.apache.ibatis.annotations.Param;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import com.web.epictrip.dao.Mypage_Dao;
import com.web.epictrip.service.Mypage_Service;
import com.web.epictrip.vo.CompanionDTO;
import com.web.epictrip.vo.Level_Vo;
import com.web.epictrip.vo.PaymentDTO;
import com.web.epictrip.vo.ReviewDTO;
import com.web.epictrip.vo.ScheduleDTO;
import com.web.epictrip.vo.WishlistDTO;

@Controller
public class Mypage_Controller {

	@Autowired
	private Mypage_Service service;
	@Autowired
	private Mypage_Dao dao;
	
	
	@RequestMapping("Mypage_mymain")
	public String Mypage_level(@Param("userid")String userid,Model d) {
		int cnt = service.Mypage_level(userid);
		
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		
		String leverName = level.getImgName();
		
		d.addAttribute("levelImg", leverName); // 레벨이름
		d.addAttribute("levelCnt", cnt); // 좋아요갯수
		return "Mypage_mymain";
	}
	// 구매내역
	@GetMapping("Mypage_mybill")
	public String Mypage_mybill(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		model.addAttribute("Payment", dao.getPurchaseHistory(userid));
		return "Mypage_mybill";
	}
	// 내 일정
	@GetMapping("Mypage_mycal")
	public String Mypage_mycal(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		model.addAttribute("Schedule", dao.getUserSchedules(userid));
		return "Mypage_mycal";
	}
	// 내 동행
	@GetMapping("Mypage_mygroup")
	public String Mypage_mygroup(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		model.addAttribute("Companion", dao.getUserCompanions(userid));
		return "Mypage_mygroup";
	}
	// 내 후기
	@GetMapping("Mypage_myreview")
	public String Mypage_myreview(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		model.addAttribute("Review", dao.getUserReviews(userid));
		return "Mypage_myreview";
	}
	// 위시리스트
	@GetMapping("Mypage_mywish")
	public String Mypage_mywish(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		model.addAttribute("Wishlist", dao.getUserWishlist(userid));
		return "Mypage_mywish";
	}
	// 계정설정
	@GetMapping("Mypage_mysetting")
	public String Mypage_mysetting(@RequestParam("userid") String userid, Model model) {
		int cnt = service.Mypage_level(userid);
		Level_Vo level = new Level_Vo();
		level.CountLevel(cnt);
		String leverName = level.getImgName();
		model.addAttribute("levelImg", leverName); // 레벨이름
		return "Mypage_mysetting";
	}
}
