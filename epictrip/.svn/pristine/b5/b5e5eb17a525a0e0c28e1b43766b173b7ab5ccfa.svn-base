<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >	
	
<mapper namespace="com.web.epictrip.dao.Mypage_Dao">
	<select id="Mypage_level" resultType="int" parameterType="String">
		SELECT count(*) AS cnt FROM levels WHERE userid = #{userid}
	</select>

    <select id="getPurchaseHistory" resultType="payment2" parameterType="String">
        SELECT TITLEIMAGE, PRODTITLE, COUNTRY, TOTPRICE, paydate, d.PRODKEY
        FROM payment p, product d
        WHERE p.prodkey = d.PRODKEY AND userid=#{userid}
        ORDER BY paydate desc
    </select>

    <select id="getUserReviews" resultType="review" parameterType="String">
        SELECT PRODTITLE, COMMENTS, UPLOADDATE
        FROM PRODCOMMENT c, product d
        WHERE c.PRODKEY = d.PRODKEY AND userid=#{userid}
        ORDER BY UPLOADDATE desc
    </select>

    <select id="getUserCompanions" resultType="companion" parameterType="String">
        SELECT IMAGE,NAME,BIRTH,GENDER,CPIMAGE,STARTDATE,ENDDATE,CPTITLE,CPNUM,HITS,CURRENTNUM, cpkey
        FROM COMPANY c , USERINFO u 
        WHERE c.USERID = u.USERID AND c.USERID = #{userid}
        ORDER BY CREATDATE DESC
    </select>

    <select id="getUserSchedules" resultType="schedule" parameterType="String">
        SELECT IMAGE, NAME, STARTDATE, ENDDATE, LOC
        FROM SCHEDULE s, USERINFO u 
        WHERE s.USERID = u.USERID AND s.USERID = #{userid}
        ORDER BY CREATDATE DESC
    </select>

    <select id="getUserWishlist" resultType="wishlist" parameterType="String">
        SELECT TITLEIMAGE, PRODTITLE, PRODLOC, PRICE
        FROM WISHLIST w, PRODUCT p 
        WHERE w.PRODKEY = p.PRODKEY AND userid = #{userid}
        ORDER BY WLDATE DESC
    </select>
</mapper>